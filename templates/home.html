{% load staticfiles %}

<!doctype html>
<html lang="">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<body>
    <div class="main-content">
        <a href="#" data-bind="click: function () { active(newTarget) }">NEW</a>
        <ul class="targets" data-bind="foreach: targets">
            <li>
                <a href="#" data-bind="text: identifier,
                                       click: $parent.activateTarget.bind($parent, $data),
                                       css: {'active': $parent.active() === $data}">
                </a>
            </li>
        </ul>

        <div class="new-target" data-bind="template: {
                                           name: 'new-target',
                                           data: newTarget,
                                           if: active() === newTarget,
                                       }, visible: active() === newTarget">
        </div>


        <div class="active-target" data-bind="template: {data: active,
                                              if: active() !== newTarget},
                                              visible: active() !== newTarget"
             style="display: none">
            <form data-bind="submit: $parent.saveTarget.bind($parent, $data)">
                <input class="search" data-bind="value: identifier"/>
                <textarea rows="4" cols="50" class="search" placeholder="description"
                            data-bind="value: description"></textarea>
                <div>
                    <a href="#" class="close" data-bind="click: imgLink.bind($data, ''), visible: imgLink"></a>
                    <img height="300" data-bind="attr: {src: imgLink}, visible: imgLink"></img>
                </div>

                <input type="submit" value="SAVE"/>
            </form>
            <button data-bind="click: $parent.setTargetDefaultDescription.bind($parent, $data)">SET DEFAULT DESCRIPTION</button>
            <button data-bind="click: $parent.removeTarget.bind($parent, $data)">DELETE</button>
        </div>
    </div>


    <script type="text/html" id="new-target">
        <form>
            <input class="search" data-bind="textInput: q" autofocus/>
            <div data-bind="visible: queryCorrection() && !loading()">
                Did you mean <a href="#" data-bind="click: correctQuery.bind($data), text: queryCorrection"></a>
            </div>
            <textarea rows="4" cols="50" class="search" placeholder="description"
                      data-bind="value: description"/></textarea>
            <div class="lds-hourglass" data-bind="style : { visibility : loading() ? '' : 'hidden'  }"></div>
            <button class="add-target" data-bind="visible: allowCreate, click: add">ADD</button>
        </form>

        <ul data-bind="foreach: links">
            <a href="#" data-bind="click: $parent.selectedLink.bind($parent, $data)">
                <img height="200" data-bind="attr: {src: $data},
                                                css: {'selected-img': $parent.selectedLink() === $data}">
                </img>
            </a>
        </ul>
    </script>


    <script src="{% static 'bundles/main.js' %}"></script>
</body>

</html>
